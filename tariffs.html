<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Приложение №1 — Тарифы</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="container">
  <div class="card">
    <h1>Приложение №1 — Тарифы</h1>
    <div class="subtitle">
      Актуальные тарифы на курьерские услуги ООО «ДАЛЕ ЮГ».
      Таблица обновляется автоматически.
    </div>

    <div class="red-line"></div>

    <div id="revision" class="badge">
      Редакция тарифов: —
    </div>

    <div class="table-wrap">
      <div class="table-scroll">
        <table id="tariffTable">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="footer">
      Источник данных — Google Sheets. Изменения вступают в силу с момента публикации.
    </div>
  </div>
</div>

<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRUvQ1UbXbVlA4SfF8rcXKqHjBiTc55eCRcCS_I-66bHEmmLaCGBo3k8LkfizggCBZTqgN1a0vBuND7/pub?output=csv";

fetch(SHEET_URL)
  .then(r => r.text())
  .then(csv => {
    const rows = csv.split("\n").map(r => r.split(","));

    // Редакция
    document.getElementById("revision").innerText =
      "Редакция тарифов: " + rows[0][1];

    // Заголовки
    const thead = document.querySelector("#tariffTable thead");
    thead.innerHTML = "<tr>" + rows[2].map(h => `<th>${h}</th>`).join("") + "</tr>";

    // Данные
    const tbody = document.querySelector("#tariffTable tbody");
    rows.slice(3).forEach(row => {
      if(row[0]){
        tbody.innerHTML += `
          <tr>
            ${row.map((c,i)=>
              i===0
                ? `<td class="city">${c}</td>`
                : `<td class="num">${c}</td>`
            ).join("")}
          </tr>`;
      }
    });
  });
</script>

</body>
</html>
